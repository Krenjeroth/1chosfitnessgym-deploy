import{z as g,_ as q,l as Y,i as Z,u as ee,a as oe}from"./upptak3D.js";import{m as ne}from"./Dj-as4XO.js";import{h as N,C as B,y as k,j as F,o as $,w as d,e as t,A as z,a as e,B as R,f as A,p as te,d as I,b as ae,D as le,E,c as re}from"./CmAaC7-r.js";import{u as j}from"./ta7sgxvC.js";import{a as J,b as K,c as L}from"./CxBsuVx0.js";import"./moRlnmHh.js";import"./B_gzkPqb.js";const ie=g.object({name:g.string({invalid_type_error:"Name is required"}).min(3,"Name must be at least 3 characters long"),description:g.string({invalid_type_error:"Description is required"}),validity:g.number({invalid_type_error:"Validity must be a number"}).int().gte(1).lte(12),price:g.string().transform(V=>Number(`${V}`.replace(",","."))).pipe(g.number())}),se=N({__name:"CreateModal",emits:["reloadTable","success","error","close"],setup(V,{emit:_}){const l=j(),{loading:r,errorBag:m,hasError:U}=B(l),o=_,i=()=>o("close"),f=()=>{o("success"),o("reloadTable"),i()},S=()=>{o("error")},c=k({name:void 0,description:void 0,validity:void 0,price:void 0}),b=async n=>{if(await l.addPlan(n.data),U.value){S();return}f()};return(n,s)=>{const v=L,u=K,M=R,C=J,P=q;return $(),F(P,{"on-close":i,title:"Create User"},{default:d(()=>[t(C,{schema:"CreatePlanValidationSchema"in n?n.CreatePlanValidationSchema:e(ie),state:e(c),onSubmit:z(b,["prevent"]),class:"space-y-6"},{default:d(()=>[t(u,{label:"Name",name:"name",error:e(m).name},{default:d(()=>[t(v,{modelValue:e(c).name,"onUpdate:modelValue":s[0]||(s[0]=a=>e(c).name=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(u,{label:"Description",name:"description",error:e(m).description},{default:d(()=>[t(v,{modelValue:e(c).description,"onUpdate:modelValue":s[1]||(s[1]=a=>e(c).description=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(u,{label:"Validity (Months ~ Max 12 Months)",name:"validity",error:e(m).validity},{default:d(()=>[t(v,{modelValue:e(c).validity,"onUpdate:modelValue":s[2]||(s[2]=a=>e(c).validity=a),type:"number"},null,8,["modelValue"])]),_:1},8,["error"]),t(u,{label:"Price",name:"price",error:e(m).price},{default:d(()=>[t(v,{modelValue:e(c).price,"onUpdate:modelValue":s[3]||(s[3]=a=>e(c).price=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(M,{type:"submit",loading:e(r)},{default:d(()=>s[4]||(s[4]=[A(" Add ")])),_:1},8,["loading"])]),_:1},8,["schema","state"])]),_:1})}}}),de=g.object({name:g.string({invalid_type_error:"Name is required"}).min(3,"Name must be at least 3 characters long"),description:g.string({invalid_type_error:"Description is required"}),validity:g.number({invalid_type_error:"Validity must be a number"}).int().gte(1).lte(12),price:g.string().transform(V=>Number(`${V}`.replace(",","."))).pipe(g.number())}),ce=N({__name:"UpdateModal",props:{plan:Object},emits:["reloadTable","success","error","noDataChange","close"],setup(V,{emit:_}){var C,P,a,D,y,O,G,H;const l=j(),{loading:r,errorBag:m,hasError:U}=B(l),o=V,i=_,f=()=>i("close"),S=()=>{i("success"),i("reloadTable"),f()},c=()=>{i("error")},b=()=>{i("noDataChange")},n=k({name:((C=o.plan)==null?void 0:C.name)??void 0,description:((P=o.plan)==null?void 0:P.description)??void 0,validity:((a=o.plan)==null?void 0:a.validity)??void 0,price:((D=o.plan)==null?void 0:D.price)??void 0}),s=k(Y.cloneDeep({name:((y=o.plan)==null?void 0:y.name)??void 0,description:((O=o.plan)==null?void 0:O.description)??void 0,validity:((G=o.plan)==null?void 0:G.validity)??void 0,price:((H=o.plan)==null?void 0:H.price)??void 0})),v=["name","description","validity","price"],u=te(()=>v.some(h=>{const p=n.value[h],x=s.value[h];return!Z(p,x)})),M=async h=>{var p;if(!u.value){b();return}if(await l.updatePlan((p=o.plan)==null?void 0:p.id,h.data),U.value){c();return}S()};return(h,p)=>{const x=L,T=K,Q=R,W=J,X=q;return $(),F(X,{"on-close":f,title:"Edit Plan"},{default:d(()=>[t(W,{schema:"UpdatePlanValidationSchema"in h?h.UpdatePlanValidationSchema:e(de),state:e(n),onSubmit:z(M,["prevent"]),class:"space-y-6"},{default:d(()=>[t(T,{label:"Name",name:"name",error:e(m).name},{default:d(()=>[t(x,{modelValue:e(n).name,"onUpdate:modelValue":p[0]||(p[0]=w=>e(n).name=w)},null,8,["modelValue"])]),_:1},8,["error"]),t(T,{label:"Description",name:"description",error:e(m).description},{default:d(()=>[t(x,{modelValue:e(n).description,"onUpdate:modelValue":p[1]||(p[1]=w=>e(n).description=w)},null,8,["modelValue"])]),_:1},8,["error"]),t(T,{label:"Validity (Months ~ Max 12 Months)",name:"validity",error:e(m).validity},{default:d(()=>[t(x,{modelValue:e(n).validity,"onUpdate:modelValue":p[2]||(p[2]=w=>e(n).validity=w),type:"number"},null,8,["modelValue"])]),_:1},8,["error"]),t(T,{label:"Price",name:"price",error:e(m).price},{default:d(()=>[t(x,{modelValue:e(n).price,"onUpdate:modelValue":p[3]||(p[3]=w=>e(n).price=w)},null,8,["modelValue"])]),_:1},8,["error"]),t(Q,{type:"submit",loading:e(r),disabled:!e(u)},{default:d(()=>p[4]||(p[4]=[A(" Update ")])),_:1},8,["loading","disabled"])]),_:1},8,["schema","state"])]),_:1})}}}),pe=N({__name:"DeleteModal",props:{plan:Object},emits:["reloadTable","success","error","close"],setup(V,{emit:_}){const l=j(),{loading:r,hasError:m}=B(l),U=V,o=_,i=()=>o("close"),f=()=>{o("success"),o("reloadTable"),i()},S=()=>{o("error")},c=async()=>{var b;if(await l.deletePlan((b=U.plan)==null?void 0:b.id),m.value){S();return}f()};return(b,n)=>{var u;const s=R,v=q;return $(),F(v,{"on-close":i,title:`Delete ${(u=U.plan)==null?void 0:u.name}`,ui:{width:"md:max-w-1xl"}},{default:d(()=>[n[1]||(n[1]=I("p",{class:"italic"},"This action cannot be undone.",-1)),n[2]||(n[2]=I("p",{class:"italic"},"All data associated with this plan will be deleted.",-1)),t(s,{variant:"solid",color:"red",class:"w-full justify-center mt-4",ui:{base:"text-center"},onClick:c,loading:e(r)},{default:d(()=>n[0]||(n[0]=[A(" Delete this plan ")])),_:1},8,["loading"])]),_:1},8,["title"])}}}),ye=N({__name:"index",setup(V){ae({title:"Plans"});const _=le(),{actionToastResult:l}=ee(),r=j(),{plans:m,loading:U,page:o,pageCount:i,search:f,sort:S,totalPlans:c,selectedStatus:b}=B(r),{columns:n,items:s,statusOptions:v}=ne;r.getPlans();const u=()=>{_.open(se,{onReloadTable(){r.getPlans()},onSuccess(){l({icon:"i-heroicons-check-circle",description:"Plan created successfully.",id:"modal-success",color:"green"})},onError(){l({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){_.close()}})},M=P=>{_.open(ce,{plan:P,onReloadTable(){r.getPlans()},onSuccess(){l({icon:"i-heroicons-check-circle",description:"Plan updated successfully.",id:"modal-success",color:"green"})},onError(){l({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onNoDataChange(){l({icon:"i-heroicons-exclamation-circle",description:"No data changes detected.",id:"modal-warning",color:"yellow"})},onClose(){_.close()}})},C=P=>{_.open(pe,{plan:P,onReloadTable(){r.getPlans()},onSuccess(){l({icon:"i-heroicons-check-circle",description:"Plan deleted.",id:"modal-success",color:"green"})},onError(){l({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){_.close()}})};return E(f,()=>{o.value=1,r.getPlans()}),E(i,()=>{o.value=1,r.getPlans()}),E([o,i],()=>{r.getPlans()}),E(b,()=>{o.value=1,r.getPlans()}),(P,a)=>{const D=oe;return $(),re("div",null,[t(D,{"module-title":"Plans",columns:e(n),"action-items":e(s),"table-data":e(m),"add-data-modal":u,loading:e(U),"action-handlers":{create:u,edit:M,delete:C},pagination:{page:e(o),pageCount:e(i),total:e(c)},sorting:e(S),search:e(f),"selected-dropdown-filter":e(b),"enable-dropdown-filter":!0,"dropdown-filter-options":e(v),"onUpdate:page":a[0]||(a[0]=y=>o.value=y),"onUpdate:pageCount":a[1]||(a[1]=y=>i.value=y),"onUpdate:sort":e(r).getPlans,"onUpdate:search":a[2]||(a[2]=y=>f.value=y),"onUpdate:selectedDropdownFilter":a[3]||(a[3]=y=>b.value=y)},null,8,["columns","action-items","table-data","loading","action-handlers","pagination","sorting","search","selected-dropdown-filter","dropdown-filter-options","onUpdate:sort"])])}}});export{ye as default};
