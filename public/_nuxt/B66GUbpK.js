import{b as J,c as K,z as T,_ as R,l as Q,i as X,u as Z,a as ee}from"./upptak3D.js";import{m as oe}from"./D6NeSRIB.js";import{p as L,F as te,y as C,h as M,C as $,j as k,o as N,w as f,e as m,A as z,a as o,B as H,f as O,d as Y,b as ae,D as se,E as B,c as re}from"./CmAaC7-r.js";import{u as ne}from"./B_gzkPqb.js";import{u as le}from"./moRlnmHh.js";import{a as G,b as I,c as W}from"./CxBsuVx0.js";const ie=()=>{const v=ne(),s=L(()=>new URL("http://1chosfitnessgym/api/users"));return{getUsersApi:async e=>await v(`${s.value}?${e.toString()}`),addUserApi:async e=>await v(`${s.value}`,{method:"POST",body:e}),updateUserApi:async(e,a)=>await v(`${s.value}/${e}`,{method:"PUT",body:a}),deleteUserApi:async e=>await v(`${s.value}/${e}`,{method:"DELETE",headers:{Accept:"application/json"}})}},F=te("userStore",()=>{const{getUsersApi:v,addUserApi:s,updateUserApi:r,deleteUserApi:n}=ie(),{hasError:g,errorBag:y,transformValidationErrors:e,resetErrorBag:a}=J(),{capitalizeWords:h}=le(),{transformUtcDatetime:E}=K();let d;(c=>{c.ASC="asc",c.DESC="desc"})(d||(d={}));const U=C([]),t=C(!1),i=C(1),w=C(5),p=C(""),V=C({column:"created_at",direction:"desc"}),A=C(0),_=C("");return{users:U,loading:t,errorBag:y,hasError:g,page:i,pageCount:w,search:p,sort:V,totalUsers:A,selectedStatus:_,getUsers:async()=>{t.value=!0;try{const c=new URLSearchParams({page:i.value.toString(),per_page:w.value.toString(),sort:V.value.column,order:V.value.direction,search:p.value,..._.value?{status:_.value}:{}}),S=await v(c);U.value=S.data.map(D=>({...D,created_at:E(D.created_at,"MMMM DD, YYYY hh:mm A")})),A.value=Number(S.meta.total)||0}catch(c){throw c}finally{t.value=!1}},addUser:async c=>{t.value=!0,a(),await s(c).catch(S=>{e(S)}).finally(()=>{t.value=!1})},updateUser:async(c,S)=>{t.value=!0,a();const D=h(S.name),j={...S,name:D};await r(c,j).catch(q=>{e(q)}).finally(()=>{t.value=!1})},deleteUser:async c=>{t.value=!0,a(),await n(c).catch(S=>{e(S)}).finally(()=>{t.value=!1})}}}),ce=T.object({name:T.string({invalid_type_error:"Name is required"}).min(3,"Name must be at least 3 characters long"),email:T.string({invalid_type_error:"Email is required"}).email("Email is not valid"),password:T.string({invalid_type_error:"Password is required"}).min(8,"Password must be at least 8 characters long")}),de=M({__name:"CreateModal",emits:["reloadTable","success","error","close"],setup(v,{emit:s}){const r=F(),{loading:n,errorBag:g,hasError:y}=$(r),e=s,a=()=>e("close"),h=()=>{e("success"),e("reloadTable"),a()},E=()=>{e("error")},d=C({name:void 0,email:void 0,password:void 0}),U=async t=>{if(await r.addUser(t.data),y.value){E();return}h()};return(t,i)=>{const w=W,p=I,V=H,A=G,_=R;return N(),k(_,{"on-close":a,title:"Create User"},{default:f(()=>[m(A,{schema:"CreateUserValidationSchema"in t?t.CreateUserValidationSchema:o(ce),state:o(d),onSubmit:z(U,["prevent"]),class:"space-y-6"},{default:f(()=>[m(p,{label:"Name",name:"name",error:o(g).name},{default:f(()=>[m(w,{modelValue:o(d).name,"onUpdate:modelValue":i[0]||(i[0]=l=>o(d).name=l)},null,8,["modelValue"])]),_:1},8,["error"]),m(p,{label:"Email",name:"email",error:o(g).email},{default:f(()=>[m(w,{modelValue:o(d).email,"onUpdate:modelValue":i[1]||(i[1]=l=>o(d).email=l)},null,8,["modelValue"])]),_:1},8,["error"]),m(p,{label:"Password",name:"password",error:o(g).password},{default:f(()=>[m(w,{modelValue:o(d).password,"onUpdate:modelValue":i[2]||(i[2]=l=>o(d).password=l),type:"password"},null,8,["modelValue"])]),_:1},8,["error"]),m(V,{type:"submit",loading:o(n)},{default:f(()=>i[3]||(i[3]=[O(" Add ")])),_:1},8,["loading"])]),_:1},8,["schema","state"])]),_:1})}}}),ue=T.object({name:T.string({invalid_type_error:"Name is required"}).min(3,"Name must be at least 3 characters long"),email:T.string({invalid_type_error:"Email is required"}).email("Email is not valid")}),me=M({__name:"UpdateModal",props:{user:Object},emits:["reloadTable","success","error","noDataChange","close"],setup(v,{emit:s}){var A,_,l,x;const r=F(),{loading:n,errorBag:g,hasError:y}=$(r),e=v,a=s,h=()=>a("close"),E=()=>{a("success"),a("reloadTable"),h()},d=()=>{a("error")},U=()=>{a("noDataChange")},t=C({name:((A=e.user)==null?void 0:A.name)??void 0,email:((_=e.user)==null?void 0:_.email)??void 0}),i=C(Q.cloneDeep({name:((l=e.user)==null?void 0:l.name)??void 0,email:((x=e.user)==null?void 0:x.email)??void 0})),w=["name","email"],p=L(()=>w.some(u=>{const b=t.value[u],c=i.value[u];return!X(b,c)})),V=async u=>{var b;if(!p.value){U();return}if(await r.updateUser((b=e.user)==null?void 0:b.id,u.data),y.value){d();return}E()};return(u,b)=>{const c=W,S=I,D=H,j=G,q=R;return N(),k(q,{"on-close":h,title:"Edit User"},{default:f(()=>[m(j,{schema:"UpdateUserValidationSchema"in u?u.UpdateUserValidationSchema:o(ue),state:o(t),onSubmit:z(V,["prevent"]),class:"space-y-6"},{default:f(()=>[m(S,{label:"Name",name:"name",error:o(g).name},{default:f(()=>[m(c,{modelValue:o(t).name,"onUpdate:modelValue":b[0]||(b[0]=P=>o(t).name=P)},null,8,["modelValue"])]),_:1},8,["error"]),m(S,{label:"Email",name:"email",error:o(g).email},{default:f(()=>[m(c,{modelValue:o(t).email,"onUpdate:modelValue":b[1]||(b[1]=P=>o(t).email=P)},null,8,["modelValue"])]),_:1},8,["error"]),m(D,{type:"submit",loading:o(n),disabled:!o(p)},{default:f(()=>b[2]||(b[2]=[O(" Update ")])),_:1},8,["loading","disabled"])]),_:1},8,["schema","state"])]),_:1})}}}),pe=M({__name:"DeleteModal",props:{user:Object},emits:["reloadTable","success","error","close"],setup(v,{emit:s}){const r=F(),{loading:n,hasError:g}=$(r),y=v,e=s,a=()=>e("close"),h=()=>{e("success"),e("reloadTable"),a()},E=()=>{e("error")},d=async()=>{var U;if(await r.deleteUser((U=y.user)==null?void 0:U.id),g.value){E();return}h()};return(U,t)=>{var p;const i=H,w=R;return N(),k(w,{"on-close":a,title:`Delete ${(p=y.user)==null?void 0:p.name}`,ui:{width:"md:max-w-1xl"}},{default:f(()=>[t[1]||(t[1]=Y("p",{class:"italic"},"This action cannot be undone.",-1)),t[2]||(t[2]=Y("p",{class:"italic"},"All data associated with this user will be deleted.",-1)),m(i,{variant:"solid",color:"red",class:"w-full justify-center mt-4",ui:{base:"text-center"},onClick:d,loading:o(n)},{default:f(()=>t[0]||(t[0]=[O(" Delete this user ")])),_:1},8,["loading"])]),_:1},8,["title"])}}}),we=M({__name:"index",setup(v){ae({title:"Users"});const s=se(),{actionToastResult:r}=Z(),n=F(),{users:g,loading:y,page:e,pageCount:a,search:h,sort:E,totalUsers:d,selectedStatus:U}=$(n),{columns:t,items:i,statusOptions:w}=oe;n.getUsers();const p=()=>{s.open(de,{onReloadTable(){n.getUsers()},onSuccess(){r({icon:"i-heroicons-check-circle",description:"User created successfully.",id:"modal-success",color:"green"})},onError(){r({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){s.close()}})},V=_=>{s.open(me,{user:_,onReloadTable(){n.getUsers()},onSuccess(){r({icon:"i-heroicons-check-circle",description:"User updated successfully.",id:"modal-success",color:"green"})},onError(){r({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onNoDataChange(){r({icon:"i-heroicons-exclamation-circle",description:"No data changes detected.",id:"modal-warning",color:"yellow"})},onClose(){s.close()}})},A=_=>{s.open(pe,{user:_,onReloadTable(){n.getUsers()},onSuccess(){r({icon:"i-heroicons-check-circle",description:"User deleted.",id:"modal-success",color:"green"})},onError(){r({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){s.close()}})};return B(h,()=>{e.value=1,n.getUsers()}),B(a,()=>{e.value=1,n.getUsers()}),B([e,a],()=>{n.getUsers()}),B(U,()=>{e.value=1,n.getUsers()}),(_,l)=>{const x=ee;return N(),re("div",null,[m(x,{"module-title":"Users",columns:o(t),"action-items":o(i),"table-data":o(g),"add-data-modal":p,loading:o(y),"action-handlers":{create:p,edit:V,delete:A},pagination:{page:o(e),pageCount:o(a),total:o(d)},sorting:o(E),search:o(h),"selected-dropdown-filter":o(U),"enable-dropdown-filter":!0,"dropdown-filter-options":o(w),"onUpdate:page":l[0]||(l[0]=u=>e.value=u),"onUpdate:pageCount":l[1]||(l[1]=u=>a.value=u),"onUpdate:sort":o(n).getUsers,"onUpdate:search":l[2]||(l[2]=u=>h.value=u),"onUpdate:selectedDropdownFilter":l[3]||(l[3]=u=>U.value=u)},null,8,["columns","action-items","table-data","loading","action-handlers","pagination","sorting","search","selected-dropdown-filter","dropdown-filter-options","onUpdate:sort"])])}}});export{we as default};
